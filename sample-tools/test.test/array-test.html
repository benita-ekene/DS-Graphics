<!DOCTYPE html>
<html>
<head>
  <title>Sorting Visualization with Data Upload</title>
  <style>
    #visualizationCanvas {
      border: 1px solid black;
    }
  </style>
</head>
<body>
  <div>
    <input type="file" id="fileInput">
    <input type="text" id="inputField" placeholder="Enter value">
    <button id="pushButton">Push</button>
    <button id="randomButton">Random</button>
    <button id="sortButton">Sort</button>
    <canvas id="visualizationCanvas" width="400" height="200"></canvas>
  </div>

  <script>
    class SortingVisualizer {
      constructor() {
        this.array = [];
        this.visualizationCanvas = document.getElementById('visualizationCanvas');
        this.ctx = this.visualizationCanvas.getContext('2d');
        this.animationSpeed = 100; // milliseconds

        this.pushButton = document.getElementById('pushButton');
        this.pushButton.addEventListener('click', this.pushValue.bind(this));

        this.randomButton = document.getElementById('randomButton');
        this.sortButton = document.getElementById('sortButton');
        this.randomButton.addEventListener('click', this.generateRandomArray.bind(this));
        this.sortButton.addEventListener('click', this.visualizeSort.bind(this));

        this.fileInput = document.getElementById('fileInput'); // Add this line
        this.fileInput.addEventListener('change', this.handleFileUpload.bind(this)); // Add this line

        this.initializeCanvas();
      }

      initializeCanvas() {
        this.ctx.clearRect(0, 0, this.visualizationCanvas.width, this.visualizationCanvas.height);
        const barWidth = 20;
        const barSpacing = 2;
        const startY = this.visualizationCanvas.height;
        for (let i = 0; i < this.array.length; i++) {
          const barHeight = this.array[i] * 10;
          const x = i * (barWidth + barSpacing);
          this.ctx.fillStyle = 'blue';
          this.ctx.fillRect(x, startY - barHeight, barWidth, barHeight);
        }
      }

      async swap(i, j) {
        await this.wait();
        [this.array[i], this.array[j]] = [this.array[j], this.array[i]];
        this.initializeCanvas();
      }

      async bubbleSort() {
        const n = this.array.length;
        for (let i = 0; i < n - 1; i++) {
          for (let j = 0; j < n - i - 1; j++) {
            if (this.array[j] > this.array[j + 1]) {
              await this.swap(j, j + 1);
            }
          }
        }
      }

      async wait() {
        return new Promise(resolve => setTimeout(resolve, this.animationSpeed));
      }

      pushValue() {
        const value = parseInt(document.getElementById('inputField').value);
        if (!isNaN(value)) {
          this.array.push(value);
          this.initializeCanvas();
          document.getElementById('inputField').value = '';
        }
      }

      generateRandomArray() {
        this.array = [];
        for (let i = 0; i < 10; i++) {
          this.array.push(Math.floor(Math.random() * 10) + 1);
        }
        this.initializeCanvas();
      }

      visualizeSort() {
        this.bubbleSort(); // You can change the sorting algorithm here
      }

      handleFileUpload(event) { // Add this function
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = () => {
            this.array = reader.result.split('\n').map(line => parseInt(line.trim()));
            this.initializeCanvas();
          };
          reader.readAsText(file);
        }
      }
    }

    const visualizer = new SortingVisualizer();
  </script>
</body>
</html>
